import{c as v,d as E,e as N}from"/build/_shared/chunk-MFPRU5OA.js";var d=v(E(),1);var n=v(N(),1);function B({ccValues:s,noteStates:i}){return(0,n.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6",children:[(0,n.jsx)("h2",{className:"text-xl font-bold mb-4",children:"\u30B0\u30E9\u30D5\u30A3\u30AB\u30EBUI"}),(0,n.jsxs)("div",{className:"mb-6",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold mb-3",children:"\u30B3\u30F3\u30C8\u30ED\u30FC\u30EB\u30C1\u30A7\u30F3\u30B8"}),(0,n.jsx)("div",{className:"grid grid-cols-4 gap-4",children:Object.entries(s).slice(0,16).map(([l,m])=>(0,n.jsx)(_,{ccNumber:parseInt(l),value:m},l))}),Object.keys(s).length===0&&(0,n.jsx)("div",{className:"text-gray-500 text-center py-8",children:"CC\u30E1\u30C3\u30BB\u30FC\u30B8\u3092\u53D7\u4FE1\u3059\u308B\u3068\u8868\u793A\u3055\u308C\u307E\u3059"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"text-lg font-semibold mb-3",children:"\u30CE\u30FC\u30C8\u72B6\u614B"}),(0,n.jsx)(H,{noteStates:i})]})]})}function _({ccNumber:s,value:i}){let l=i/127*100,m=2*Math.PI*28,u=`${l/100*m} ${m}`;return(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsxs)("div",{className:"relative w-16 h-16 mx-auto mb-2",children:[(0,n.jsxs)("svg",{className:"w-16 h-16 transform -rotate-90",children:[(0,n.jsx)("circle",{cx:"32",cy:"32",r:"28",stroke:"currentColor",strokeWidth:"4",fill:"none",className:"text-gray-600"}),(0,n.jsx)("circle",{cx:"32",cy:"32",r:"28",stroke:"currentColor",strokeWidth:"4",fill:"none",strokeDasharray:u,className:"text-blue-400 transition-all duration-200",style:{filter:`drop-shadow(0 0 ${Math.max(2,l/10)}px rgb(96 165 250))`}})]}),(0,n.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,n.jsx)("span",{className:"text-xs font-bold",children:i})})]}),(0,n.jsxs)("div",{className:"text-xs text-gray-400",children:["CC",s]})]})}function H({noteStates:s}){let i=[0,2,4,5,7,9,11],l=[1,3,6,8,10],m=r=>{let o=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],g=Math.floor(r/12)-1;return`${o[r%12]}${g}`},u=r=>l.includes(r%12);return(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"bg-gray-900 p-4 rounded",children:[(0,n.jsx)("h4",{className:"text-sm font-medium mb-2",children:"\u30D4\u30A2\u30CE\u30AD\u30FC\u30DC\u30FC\u30C9 (C4-B4)"}),(0,n.jsxs)("div",{className:"relative h-20",children:[i.map((r,o)=>{let g=60+r,b=s[g];return(0,n.jsx)("div",{className:`absolute h-full w-8 border border-gray-600 rounded-b transition-all duration-100 ${b?"bg-green-400 shadow-lg shadow-green-400/50":"bg-white"}`,style:{left:`${o*32}px`},title:m(g)},`white-${r}`)}),l.map((r,o)=>{let g=60+r,b=s[g];return(0,n.jsx)("div",{className:`absolute h-12 w-5 rounded-b transition-all duration-100 z-10 ${b?"bg-green-300 shadow-lg shadow-green-300/50":"bg-gray-800"}`,style:{left:`${[20,52,116,148,180][o]}px`},title:m(g)},`black-${r}`)})]})]}),(0,n.jsxs)("div",{className:"bg-gray-900 p-4 rounded",children:[(0,n.jsx)("h4",{className:"text-sm font-medium mb-2",children:"\u5168\u30CE\u30FC\u30C8\u72B6\u614B (0-127)"}),(0,n.jsx)("div",{className:"grid grid-cols-16 gap-1 max-h-32 overflow-y-auto",children:Array.from({length:128},(r,o)=>(0,n.jsx)("div",{className:`w-4 h-4 rounded transition-all duration-200 ${s[o]?u(o)?"bg-purple-400 shadow-lg shadow-purple-400/50":"bg-green-400 shadow-lg shadow-green-400/50":u(o)?"bg-gray-700":"bg-gray-600"}`,title:`${m(o)} (${o})`},o))})]})]})}var y=v(E(),1),e=v(N(),1);function F({messages:s,filteredMessages:i}){let l=(0,y.useRef)(null);(0,y.useEffect)(()=>{l.current?.scrollIntoView({behavior:"smooth"})},[i]);let m=r=>{switch(r){case"Note On":return"text-green-400";case"Note Off":return"text-red-400";case"Control Change":return"text-blue-400";case"Program Change":return"text-purple-400";case"Pitch Bend":return"text-yellow-400";default:return"text-gray-400"}},u=r=>{switch(r){case"Note On":return"\u{1F3B5}";case"Note Off":return"\u{1F507}";case"Control Change":return"\u{1F39B}\uFE0F";case"Program Change":return"\u{1F3B9}";case"Pitch Bend":return"\u{1F39A}\uFE0F";default:return"\u{1F4E1}"}};return(0,e.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6",children:[(0,e.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,e.jsx)("h2",{className:"text-xl font-bold",children:"\u30E1\u30C3\u30BB\u30FC\u30B8\u30ED\u30B0"}),(0,e.jsxs)("div",{className:"flex items-center gap-4 text-sm",children:[(0,e.jsxs)("span",{className:"text-gray-400",children:["\u8868\u793A\u4E2D: ",i.length]}),(0,e.jsxs)("span",{className:"text-gray-400",children:["\u7DCF\u8A08: ",s.length]})]})]}),(0,e.jsxs)("div",{className:"h-96 overflow-y-auto bg-gray-900 rounded p-4 font-mono text-sm",children:[i.length===0?(0,e.jsxs)("div",{className:"text-gray-500 text-center py-8",children:[(0,e.jsx)("div",{className:"text-4xl mb-2",children:"\u{1F3B9}"}),(0,e.jsx)("div",{children:"MIDI\u30C7\u30D0\u30A4\u30B9\u3092\u9078\u629E\u3057\u3066\u30E1\u30C3\u30BB\u30FC\u30B8\u3092\u53D7\u4FE1\u3057\u3066\u304F\u3060\u3055\u3044"})]}):(0,e.jsx)("div",{className:"space-y-2",children:i.map((r,o)=>(0,e.jsx)(Q,{message:r,isLatest:o===i.length-1},r.id))}),(0,e.jsx)("div",{ref:l})]})]})}function Q({message:s,isLatest:i}){let l=r=>{switch(r){case"Note On":return"text-green-400";case"Note Off":return"text-red-400";case"Control Change":return"text-blue-400";case"Program Change":return"text-purple-400";case"Pitch Bend":return"text-yellow-400";default:return"text-gray-400"}},m=r=>{switch(r){case"Note On":return"\u{1F3B5}";case"Note Off":return"\u{1F507}";case"Control Change":return"\u{1F39B}\uFE0F";case"Program Change":return"\u{1F3B9}";case"Pitch Bend":return"\u{1F39A}\uFE0F";default:return"\u{1F4E1}"}},u=r=>{let o=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],g=Math.floor(r/12)-1;return`${o[r%12]}${g}`};return(0,e.jsxs)("div",{className:`p-3 rounded transition-all duration-300 ${i?"bg-gray-700 border-l-4 border-blue-400 shadow-lg":"bg-gray-800 hover:bg-gray-750"}`,children:[(0,e.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,e.jsxs)("div",{className:"flex items-center gap-2",children:[(0,e.jsx)("span",{className:"text-lg",children:m(s.type)}),(0,e.jsx)("span",{className:`font-semibold ${l(s.type)}`,children:s.type})]}),(0,e.jsx)("span",{className:"text-gray-400 text-xs",children:new Date(s.timestamp).toLocaleTimeString("ja-JP",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit",fractionalSecondDigits:3})})]}),(0,e.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,e.jsxs)("div",{className:"space-y-1",children:[(0,e.jsxs)("div",{className:"text-gray-300",children:[(0,e.jsxs)("span",{className:"text-yellow-400 font-medium",children:["Ch",s.channel]}),(0,e.jsxs)("span",{className:"text-gray-500 ml-2",children:["(",s.port,")"]})]}),s.note!==void 0&&(0,e.jsxs)("div",{className:"text-gray-300",children:[(0,e.jsx)("span",{className:"text-gray-400",children:"Note:"}),(0,e.jsxs)("span",{className:"ml-1 font-medium",children:[u(s.note)," (",s.note,")"]})]}),s.velocity!==void 0&&(0,e.jsxs)("div",{className:"text-gray-300",children:[(0,e.jsx)("span",{className:"text-gray-400",children:"Velocity:"}),(0,e.jsx)("span",{className:"ml-1 font-medium",children:s.velocity})]})]}),(0,e.jsxs)("div",{className:"space-y-1",children:[s.controller!==void 0&&(0,e.jsxs)("div",{className:"text-gray-300",children:[(0,e.jsx)("span",{className:"text-gray-400",children:"CC:"}),(0,e.jsx)("span",{className:"ml-1 font-medium",children:s.controller})]}),s.value!==void 0&&(0,e.jsxs)("div",{className:"text-gray-300",children:[(0,e.jsx)("span",{className:"text-gray-400",children:"Value:"}),(0,e.jsx)("span",{className:"ml-1 font-medium",children:s.value})]}),s.program!==void 0&&(0,e.jsxs)("div",{className:"text-gray-300",children:[(0,e.jsx)("span",{className:"text-gray-400",children:"Program:"}),(0,e.jsx)("span",{className:"ml-1 font-medium",children:s.program})]})]})]}),(0,e.jsxs)("div",{className:"text-xs text-gray-500 mt-2 font-mono",children:["Raw: [",s.data.map(r=>r.toString(16).padStart(2,"0").toUpperCase()).join(" "),"]"]})]})}var a=v(N(),1),X=()=>[{title:"MIDI Monitor"},{name:"description",content:"MIDI\u30B3\u30F3\u30C8\u30ED\u30FC\u30E9\u5165\u529B\u30E2\u30CB\u30BF\u30FC\u30A2\u30D7\u30EA"}];function L(){let[s,i]=(0,d.useState)(null),[l,m]=(0,d.useState)([]),[u,r]=(0,d.useState)(""),[o,g]=(0,d.useState)([]),[b,I]=(0,d.useState)(!0),[M,V]=(0,d.useState)(null),[C,j]=(0,d.useState)(""),[R,$]=(0,d.useState)({}),[U,D]=(0,d.useState)({});(0,d.useEffect)(()=>{if(!navigator.requestMIDIAccess){I(!1);return}navigator.requestMIDIAccess({sysex:!1}).then(t=>{i(t),A(t),t.onstatechange=()=>{A(t)}}).catch(t=>{console.error("MIDI access failed:",t),I(!1)})},[]);let A=t=>{let p=[];t.inputs.forEach(c=>{p.push({id:c.id,name:c.name||"Unknown Device",manufacturer:c.manufacturer||"Unknown",state:c.state||"connected"})}),m(p)},T=t=>{if(!t.data)return;let[p,c,f]=t.data,W=(p&15)+1,q=p&240,h="Unknown",w,k,O,P,S;switch(q){case 128:h="Note Off",w=c,k=f,D(x=>({...x,[c]:!1}));break;case 144:h=f>0?"Note On":"Note Off",w=c,k=f,D(x=>({...x,[c]:f>0}));break;case 176:h="Control Change",O=c,P=f,$(x=>({...x,[c]:f}));break;case 192:h="Program Change",S=c;break;case 224:h="Pitch Bend",P=f<<7|c;break}let J={id:`${Date.now()}-${Math.random()}`,timestamp:t.timeStamp||Date.now(),port:t.target?.name||"Unknown",channel:W,type:h,data:Array.from(t.data),note:w,velocity:k,controller:O,value:P,program:S};g(x=>[...x,J])};(0,d.useEffect)(()=>{if(!s||!u)return;let t=s.inputs.get(u);if(t)return t.onmidimessage=T,()=>{t.onmidimessage=null}},[s,u]);let K=o.filter(t=>!(M&&t.channel!==M||C&&t.type!==C)),z=()=>{let t=JSON.stringify(o,null,2),p="data:application/json;charset=utf-8,"+encodeURIComponent(t),c=`midi-log-${new Date().toISOString().slice(0,19).replace(/:/g,"-")}.json`,f=document.createElement("a");f.setAttribute("href",p),f.setAttribute("download",c),f.click()},G=()=>{g([]),$({}),D({})};return b?(0,a.jsx)("div",{className:"min-h-screen bg-gray-900 text-white",children:(0,a.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,a.jsxs)("header",{className:"mb-8",children:[(0,a.jsx)("h1",{className:"text-4xl font-bold mb-4 text-center bg-gradient-to-r from-blue-400 to-purple-500 bg-clip-text text-transparent",children:"MIDI Monitor"}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-4 items-center justify-center",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"\u30C7\u30D0\u30A4\u30B9:"}),(0,a.jsxs)("select",{value:u,onChange:t=>r(t.target.value),className:"bg-gray-800 border border-gray-600 rounded px-3 py-1 text-sm",children:[(0,a.jsx)("option",{value:"",children:"\u30C7\u30D0\u30A4\u30B9\u3092\u9078\u629E"}),l.map(t=>(0,a.jsxs)("option",{value:t.id,children:[t.name," (",t.manufacturer,")"]},t.id))]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"\u30C1\u30E3\u30F3\u30CD\u30EB:"}),(0,a.jsxs)("select",{value:M||"",onChange:t=>V(t.target.value?parseInt(t.target.value):null),className:"bg-gray-800 border border-gray-600 rounded px-3 py-1 text-sm",children:[(0,a.jsx)("option",{value:"",children:"\u5168\u3066"}),Array.from({length:16},(t,p)=>(0,a.jsxs)("option",{value:p+1,children:["Ch ",p+1]},p+1))]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"\u30BF\u30A4\u30D7:"}),(0,a.jsxs)("select",{value:C,onChange:t=>j(t.target.value),className:"bg-gray-800 border border-gray-600 rounded px-3 py-1 text-sm",children:[(0,a.jsx)("option",{value:"",children:"\u5168\u3066"}),(0,a.jsx)("option",{value:"Note On",children:"Note On"}),(0,a.jsx)("option",{value:"Note Off",children:"Note Off"}),(0,a.jsx)("option",{value:"Control Change",children:"Control Change"}),(0,a.jsx)("option",{value:"Program Change",children:"Program Change"}),(0,a.jsx)("option",{value:"Pitch Bend",children:"Pitch Bend"})]})]}),(0,a.jsx)("button",{onClick:z,className:"bg-blue-600 hover:bg-blue-700 px-4 py-1 rounded text-sm font-medium transition-colors",children:"\u30ED\u30B0\u51FA\u529B"}),(0,a.jsx)("button",{onClick:G,className:"bg-red-600 hover:bg-red-700 px-4 py-1 rounded text-sm font-medium transition-colors",children:"\u30AF\u30EA\u30A2"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,a.jsx)(B,{ccValues:R,noteStates:U}),(0,a.jsx)(F,{messages:o,filteredMessages:K})]})]})}):(0,a.jsx)("div",{className:"min-h-screen bg-gray-900 text-white flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h1",{className:"text-4xl font-bold mb-4",children:"MIDI Monitor"}),(0,a.jsx)("p",{className:"text-red-400",children:"\u3053\u306E\u30D6\u30E9\u30A6\u30B6\u306FWebMIDI API\u3092\u30B5\u30DD\u30FC\u30C8\u3057\u3066\u3044\u307E\u305B\u3093\u3002"}),(0,a.jsx)("p",{className:"text-gray-400 mt-2",children:"Chrome\u3001Edge\u3001\u307E\u305F\u306FOpera\u3092\u3054\u4F7F\u7528\u304F\u3060\u3055\u3044\u3002"})]})})}export{L as default,X as meta};
